# 回归与聚类算法详解

## 1. 线性回归

### 1.1 基本概念
- 目标：预测连续型数据
- 核心公式：y = wᵀx + b
  - y：预测值
  - w：权重向量
  - x：特征向量
  - b：偏置项

### 1.2 线性模型分类
1. 普通线性模型
   ```
   y = w₁x₁ + w₂x₂ + ... + wₙxₙ + b
   ```

2. 广义线性模型
   - 允许特征的非线性组合
   ```
   y = w₁x₁ + w₂x₁² + w₃x₁³ + w₄x₂³ + ... + b
   ```

3. 重要概念
   - 线性关系：变量之间呈线性关系
   - 线性模型：参数呈线性关系
   - 关系：线性关系一定是线性模型，但线性模型不一定是线性关系

### 1.3 模型优化
1. 损失函数
   - 最小二乘法：Σ(y预测 - y真实)²
   - 目标：最小化预测值与真实值的差异

2. 优化方法
   - 正规方程：
     - 直接求解最优参数
     - 适用于特征量较小的情况
     - 计算复杂度高：O(n³)

   - 梯度下降：
     - 迭代优化方法
     - 计算复杂度相对较低
     - 可处理大规模数据

### 1.4 模型评估
- 均方误差(MSE)：Σ(y预测 - y真实)² / n
- R²分数：1 - (残差平方和/总平方和)

## 2. 过拟合与欠拟合

### 2.1 欠拟合
- 表现：模型太简单，无法捕获数据特征
- 原因：
  - 特征太少
  - 模型过于简单
- 解决方案：
  - 增加特征数量
  - 使用更复杂的模型

### 2.2 过拟合
- 表现：训练集表现好，测试集表现差
- 原因：
  - 特征过多
  - 存在噪声特征
  - 模型过于复杂
- 解决方案：正则化
  1. L1正则化(LASSO)
     - 损失函数 + λ|w|
     - 可产生稀疏解
  
  2. L2正则化(Ridge)
     - 损失函数 + λ|w|²
     - 更常用
     - 防止参数过大

## 3. 岭回归(Ridge Regression)

### 3.1 基本原理
- 在线性回归基础上添加L2正则化
- 目标函数：最小化(损失函数 + α||w||²)
- 参数：
  - α：正则化强度
  - 较大的α：更强的正则化

### 3.2 特点
- 防止过拟合
- 处理特征多重共线性
- 参数值更稳定

## 4. 逻辑回归

### 4.1 应用场景
- 二分类问题：
  - 广告点击预测
  - 垃圾邮件识别
  - 疾病诊断
  - 欺诈检测
  - 用户识别

### 4.2 核心原理
1. 模型结构：
   - 线性部分：z = wᵀx + b
   - sigmoid激活：y = 1/(1 + e^(-z))
   - 输出范围：[0,1]

2. 损失函数：
   - 对数似然损失
   - 比均方误差更适合二分类问题

3. 优化方法：
   - 主要使用梯度下降
   - 可以使用各种优化器(如SGD、Adam等)

### 4.3 模型评估
1. 混淆矩阵
   - TP：真正例
   - FP：假正例
   - TN：真反例
   - FN：假反例

2. 评估指标
   - 精确率 = TP/(TP+FP)
   - 召回率 = TP/(TP+FN)
   - F1分数 = 2×(精确率×召回率)/(精确率+召回率)
   - ROC曲线与AUC指标

## 5. K-means聚类

### 5.1 基本概念
- 无监督学习算法
- 目标：将数据分为K个簇
- 核心思想：最小化簇内距离，最大化簇间距离

### 5.2 算法步骤
1. 随机选择K个中心点
2. 分配：将每个样本分配到最近的中心点
3. 更新：重新计算每个簇的中心点
4. 重复2-3步直到收敛

### 5.3 性能评估
- 轮廓系数(Silhouette Coefficient)
  - 范围：[-1,1]
  - 越接近1表示聚类效果越好
  - 计算：(b-a)/max(a,b)
    - a：样本与同簇其他样本的平均距离
    - b：样本与最近的其他簇的平均距离

### 5.4 应用场景
- 客户分群
- 图像分割
- 异常检测
- 模式识别

### 5.5 优缺点
优点：
- 实现简单
- 计算效率高
- 可扩展性好

缺点：
- 需要预先指定K值
- 对初始中心点敏感
- 对异常值敏感
- 只能发现凸形状的簇

### 5.6 使用建议
1. K值选择：
   - 肘部法则
   - 轮廓系数
   - 业务需求

2. 预处理：
   - 标准化
   - 异常值处理
   - 特征选择

3. 结果解释：
   - 结合业务含义
   - 可视化分析
   - 验证合理性
<!--stackedit_data:
eyJoaXN0b3J5IjpbNDQwMjY3ODYwXX0=
-->